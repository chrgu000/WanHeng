<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @author yangjun -->
<mapper namespace="com.fengyun.dao.ITeacherDao">
	<sql id="columnsAs">
		t1.id, t1.user_id, t1.evaluation_score, t1.course_num,
		t1.project_score, t1.name, t1.introduce, t1.head_pic_url,
		t1.teacher_certification, t1.academic_certificate,
		t1.other_certificate, t1.check_status, t1.apply_date, t1.role_type,
		t1.is_apply,t1.composition,t1.check_idea
	</sql>
	<select id="selectTeacherPage" resultType="com.fengyun.entity.TeacherVo">
		select
		<include refid="columnsAs" />
		from
		y_teacher t1
		join
		(SELECT
		id
		from
		y_teacher
		<where>
			<if test="search.startDate!=null and search.startDate!=''">
				and apply_date>=#{search.startDate}
			</if>
			<if test="search.endDate!=null and search.endDate!=''">
				and apply_date&lt;=#{search.endDate}
			</if>
			<if test="name!=null and name!=''">
				and name like "%"#{name}"%"
			</if>
			<if test="role_type=='role_type'">
				and role_type ='Y'
			</if>
			<if test="role_type=='is_apply'">
				and is_apply ='Y'
			</if>
			<if test='check_status=="Y" and role_type!="role_type"'>
				and (check_status='Y' or is_apply ='Y')
			</if>
			<if test='check_status!="" and check_status!=null and check_status!="Y"'>
				and check_status=#{check_status}
			</if>
		</where>
		limit #{firstrownum}, #{limit}) t2
		where t1.id = t2.id order by t1.id
		desc
	</select>

	<select id="selectTeacherCount" resultType="java.lang.Long">
		select
		count(id)
		from y_teacher
		<where>
			<if test="search.startDate!=null and search.startDate!=''">
				and apply_date>=#{search.startDate}
			</if>
			<if test="search.endDate!=null and search.endDate!=''">
				and apply_date&lt;=#{search.endDate}
			</if>
			<if test="name!=null and name!=''">
				and name like "%"#{name}"%"
			</if>
			<if test="role_type=='role_type'">
				and role_type ='Y'
			</if>
			<if test="role_type=='is_apply'">
				and is_apply ='Y'
			</if>
			<if test='check_status=="Y" and role_type!="role_type"'>
				and (check_status='Y' or is_apply ='Y')
			</if>
			<if test='check_status!="" and check_status!=null and check_status!="Y"'>
				and check_status=#{check_status}
			</if>
		</where>
	</select>

</mapper>